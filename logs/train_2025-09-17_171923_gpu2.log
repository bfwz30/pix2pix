----------------- Options ---------------
               batch_size: 1                             
                    beta1: 0.5                           
          checkpoints_dir: checkpoints                   	[default: ./checkpoints]
           continue_train: False                         
                crop_size: 256                           
                 dataroot: datasets/rhino_aligned        	[default: None]
             dataset_mode: aligned                       
                direction: AtoB                          
             display_freq: 400                           
          display_winsize: 256                           
                    epoch: latest                        
              epoch_count: 1                             
                 gan_mode: vanilla                       
                init_gain: 0.02                          
                init_type: normal                        
                 input_nc: 3                             
                  isTrain: True                          	[default: None]
                lambda_L1: 100.0                         
               lambda_roi: 4.0                           	[default: 0.0]
                load_iter: 0                             	[default: 0]
                load_size: 286                           
                       lr: 0.0002                        
           lr_decay_iters: 50                            
                lr_policy: linear                        
                masks_dir: datasets/rhino_aligned/train_masks	[default: ]
         max_dataset_size: inf                           
                    model: pix2pix                       	[default: cycle_gan]
                 n_epochs: 100                           
           n_epochs_decay: 100                           
               n_layers_D: 3                             
                     name: rhino_pix2pix_roi             	[default: experiment_name]
                      ndf: 64                            
                     netD: basic                         
                     netG: unet_256                      
                      ngf: 64                            
               no_dropout: False                         
                  no_flip: False                         
                  no_html: False                         
                     norm: batch                         
              num_threads: 4                             
                output_nc: 3                             
                    phase: train                         
                pool_size: 0                             
               preprocess: none                          	[default: resize_and_crop]
               print_freq: 100                           
             save_by_iter: False                         
          save_epoch_freq: 5                             
         save_latest_freq: 5000                          
           serial_batches: False                         
                   suffix:                               
         update_html_freq: 1000                          
                use_wandb: False                         
                  verbose: False                         
       wandb_project_name: CycleGAN-and-pix2pix          
----------------- End -------------------
Initialized with device cuda:0
dataset [AlignedDataset] was created
The number of training images = 962
model [Pix2PixModel] was created
Initialized with device cuda:0
initialize network with normal
Initialized with device cuda:0
initialize network with normal
---------- Networks initialized -------------
[Network G] Total number of parameters : 54.414 M
[Network D] Total number of parameters : 2.769 M
-----------------------------------------------
create web directory checkpoints/rhino_pix2pix_roi/web...
Traceback (most recent call last):
  File "train.py", line 50, in <module>
    for i, data in enumerate(dataset):  # inner loop within one epoch
  File "/data1/liutao/pix2pix/data/__init__.py", line 99, in __iter__
    for i, data in enumerate(self.dataloader):
  File "/home/omnisky/anaconda3/envs/liutao/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/omnisky/anaconda3/envs/liutao/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/home/omnisky/anaconda3/envs/liutao/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/home/omnisky/anaconda3/envs/liutao/lib/python3.8/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
UnboundLocalError: Caught UnboundLocalError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/omnisky/anaconda3/envs/liutao/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/omnisky/anaconda3/envs/liutao/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/omnisky/anaconda3/envs/liutao/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/data1/liutao/pix2pix/data/aligned_dataset.py", line 41, in __getitem__
    AB = Image.open(AB_path).convert("RGB")
UnboundLocalError: local variable 'Image' referenced before assignment

